<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="noindex">
<link rel="stylesheet" href="css/w3.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="css/lp.css">
<script type="text/javascript" charset="utf8" src="js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" charset="utf8" src="js/jquery.dataTables.js"></script>
<script type="text/javascript" charset="utf8" src="js/jquery.dataTables.columnFilter.js"></script>
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-26708167-1', 'auto');
	ga('send', 'pageview');
</script>
</head>
<body class="w3-dark-grey w3-small" style="line-height: normal;">

<div id="navigation"></div>

<div id="sm_liiga" class="league">
	<ul class="w3-navbar w3-small w3-black w3-left-align">
		<li class="w3-hide-large w3-black w3-opennav w3-right">
			<a href="javascript:void(0);" onclick="openSmallNavi('liigaSmallNavi')"><i class="fa fa-bars"></i></a>
		</li>
		<li>
		<a onclick="leagueDropDown('liiga_drop')" href="#/">Liiga <i class="fa fa-caret-down"></i></a>
		<div id="liiga_drop" class="w3-dropdown-content w3-blue-grey w3-card-4">
			<a href="#/" onclick="changeLeague('nhl')">NHL</a>
		</div>
		</li>
		<li class="w3-hide-small tablink" onclick="openLink('Ottelulista');"><a href="#/">Ottelulista</a></li>
		<li class="w3-hide-small tablink" onclick="openLink('Pelaajalista');"><a href="#/">Pelaajalista</a></li>
		<li class="w3-hide-small tablink" onclick="openLink('Optimijoukkue');"><a href="#/">Optimijoukkue</a></li>
		<li class="w3-hide-small tablink" onclick="openLink('Kokoonpanot');"><a href="#/">Kokoonpanot</a></li>
		<li class="w3-hide-small w3-hide-medium w3-right"><a href="mailto:jepponen@gmail.com">eMail</a></li>
		<li class="w3-hide-small w3-hide-medium w3-right tablink" onclick="openLink('Status');"><a href="#/">Status</a></li>
	</ul>

	<div id="liigaSmallNavi" class="w3-hide w3-hide-large">
		<ul class="w3-navbar w3-left-align w3-small w3-blue-grey">
		<li class="w3-hide-medium w3-border-bottom" onclick="openLink('Ottelulista');"><a href="#/">Ottelulista</a></li>
		<li class="w3-hide-medium w3-border-bottom" onclick="openLink('Pelaajalista');"><a href="#/">Pelaajalista</a></li>
		<li class="w3-hide-medium w3-border-bottom" onclick="openLink('Optimijoukkue');"><a href="#/">Optimijoukkue</a></li>
		<li class="w3-hide-medium w3-border-bottom" onclick="openLink('Kokoonpanot');"><a href="#/">Kokoonpanot</a></li>
		<li class="w3-border-bottom" style="width:100%"><a style="width:100%" href="mailto:jepponen@gmail.com">eMail</a></li>
		<li style="width:100%" onclick="openLink('Status');"><a style="width:100%" href="#/">Status</a></li>
		</ul>
	</div>
</div>

<div id="nhl" class="league">
	<ul class="w3-navbar w3-small w3-black w3-left-align">
		<li class="w3-hide-large w3-black w3-opennav w3-right">
			<a href="javascript:void(0);" onclick="openSmallNavi('nhlSmallNavi')"><i class="fa fa-bars"></i></a>
		</li>
		<li>
		<a onclick="leagueDropDown('nhl_drop')" href="#/">NHL <i class="fa fa-caret-down"></i></a>
		<div id="nhl_drop" class="w3-dropdown-content w3-blue-grey w3-card-4">
			<a href="#/" onclick="changeLeague('sm_liiga')">Liiga</a>
		</div>
		</li>
		<li class="w3-hide-small tablink" onclick="openLink('Ottelulista');"><a href="#/">Ottelulista</a></li>
		<li class="w3-hide-small tablink" onclick="openLink('Pelaajalista');"><a href="#/">Pelaajalista</a></li>
		<li class="w3-hide-small tablink" onclick="openLink('Optimijoukkue');"><a href="#/">Optimijoukkue</a></li>
		<li class="w3-hide-small w3-hide-medium w3-right"><a href="mailto:jepponen@gmail.com">eMail</a></li>
		<li class="w3-hide-small w3-hide-medium w3-right tablink" onclick="openLink('Status');"><a href="#/">Status</a></li>
	</ul>

	<div id="nhlSmallNavi" class="w3-hide w3-hide-large">
		<ul class="w3-navbar w3-left-align w3-small w3-blue-grey">
		<li class="w3-hide-medium w3-border-bottom" onclick="openLink('Ottelulista');"><a href="#/">Ottelulista</a></li>
		<li class="w3-hide-medium w3-border-bottom" onclick="openLink('Pelaajalista');"><a href="#/">Pelaajalista</a></li>
		<li class="w3-hide-medium w3-border-bottom" onclick="openLink('Optimijoukkue');"><a href="#/">Optimijoukkue</a></li>
		<li class="w3-border-bottom" style="width:100%"><a style="width:100%" href="mailto:jepponen@gmail.com">eMail</a></li>
		<li style="width:100%" onclick="openLink('Status');"><a style="width:100%" href="#/">Status</a></li>
		</ul>
	</div>
</div>

<script>
$(document).ready(function() {
	changeLeague("sm_liiga");
});

function initPlayerListTable() {
	var t = $("#playertable").dataTable({
		"paging": false,
		<!-- Jarjestys aluksi -->
		"order": [[ 10, "desc" ]],
		<!-- Jarjestys klikatessa -->
		"aoColumns": [
			null,
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			{ "asSorting": [ "desc", "asc" ] },
			null
		],
		<!-- Secondary sorttaus -->
		columnDefs: [ {
			targets: [ 1 ],
			orderData: [ 1, 12 ]
		}, {
			targets: [ 2 ],
			orderData: [ 2, 12 ]
		}, {
			targets: [ 4 ],
			orderData: [ 4, 6, 12 ]
		}, {
			targets: [ 5 ],
			orderData: [ 5, 6, 12 ]
		}, {
			targets: [ 6 ],
			orderData: [ 6, 4, 12 ]
		}, {
			targets: [ 7 ],
			orderData: [ 7, 12 ]
		}, {
			targets: [ 8 ],
			orderData: [ 8, 12 ]
		}, {
			targets: [ 9 ],
			orderData: [ 9, 12 ]
		}, {
			targets: [ 10 ],
			orderData: [ 10, 12 ]
		}, {
			targets: [ 11 ],
			orderData: [ 11, 12 ]
		} ]
	})
	.columnFilter({aoColumns:[
		null,
		{ sSelector: "#pelipaikka", type:"select" },
		{ sSelector: "#joukkue", type:"select" },
		null, null, null, null, null, null, null, null, null, null, null
	]});

}

function leagueDropDown(id) {
    var x = document.getElementById(id);
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
}

function closeAllLeagueDropDowns() {
	var dropDowns = $('div.w3-dropdown-content');
	jQuery.each(dropDowns, function(i, dropDown) {
		dropDown.className = dropDown.className.replace(" w3-show", "");
	});
}

function changeLeague(league) {
    var i;
    var x = document.getElementsByClassName("league");
    for (i = 0; i < x.length; i++) {
       x[i].style.display = "none";
    }
    document.getElementById(league).style.display = "block";
	init();
	selectDefaultTab(league);
	closeAllLeagueDropDowns();
}

function init() {
	var elements, i, j;
	var classes = ["startDayOption", "endDayOption", "selectedTeams", "periodOptionMenu", "maxPelatutPelit"];
	for (j = 0; j < classes.length; j++) {
		elements = document.getElementsByClassName(classes[j]);
		for (i = 0; i < elements.length; i++) {
			elements[i].innerHTML = '';
		}
	}
	$('.removedPlayers').val('');
	showSlide(1);
}

function openSmallNavi(id) {
    var x = document.getElementById(id);
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
}

function openLink(linkName) {
	showLinkDiv(linkName);
	callFunction(linkName);
	markClickedTab(linkName);
}

function showLinkDiv(linkName) {
    var i;
    var x = document.getElementsByClassName("link");
    for (i = 0; i < x.length; i++) {
       x[i].style.display = "none";
    }
    document.getElementById(linkName).style.display = "block";
}

function callFunction (linkName) {
	//https://www.sitepoint.com/call-javascript-function-string-without-using-eval/
	// find object
	var fn = window[linkName];

	// is object a function?
	if (typeof fn === "function") fn();
}

function markClickedTab(linkName) {
	var i, tablinks;
	tablinks = document.getElementsByClassName('tablink');
	for (i = 0; i < tablinks.length; i++) {
		tablinks[i].className = tablinks[i].className.replace(" w3-red", "");
		if ($(tablinks[i]).text() == linkName) {
			tablinks[i].className += " w3-red";
		}
	}
}

function getSelectedLeague() {
	var league;
	var i;
	var x = document.getElementsByClassName("league");
    for (i = 0; i < x.length; i++) {
       if (x[i].style.display == "block") {
			league = $(x[i]).attr("id");
	   }
    }
	return league;
}

function selectDefaultTab(league) {
	var mybtn = $('div#' + league).find('.tablink')[0];
	mybtn.click();
}

function showSlide(n) {
	var i;
	var x = document.getElementsByClassName("slideDiv");
	var dots = document.getElementsByClassName("slideButton");
	for (i = 0; i < x.length; i++) {
		x[i].style.display = "none";
	}
	for (i = 0; i < dots.length; i++) {
		dots[i].className = dots[i].className.replace(" w3-red", "");
	}
	x[n-1].style.display = "block";
	dots[n-1].className += " w3-red";
}

function Ottelulista(subList) {
	if (subList === undefined) {
		subList = 'gameDays,teamCompareTable,optimalChangeDay,startDayOption,endDayOption';
	}
	var league = getSelectedLeague();
	var startDay = $('#Ottelulista').find('.startDayOption option:selected').html();
	var endDay = $('#Ottelulista').find('.endDayOption option:selected').html();
	var teamFrom = $('.teamFrom option:selected').html();

	ga('set', 'page', '/virtual/' + league + '/Ottelulista.html');
	ga('send', 'pageview');

	$.ajax({
		type: 'POST',
		url: 'lp.pl',
		data: {'sub':subList,'liiga':league,'start_day':startDay,'end_day':endDay,'team_from':teamFrom},
		dataType: 'json',
		success: function(res) {
			$.each(res, function (name, value) {
				$('#Ottelulista').find('.' + name).html(value);
			});
		},
		error: function() {
			$('.gameDays').html("Some problem occurred trying to run Ottelulista");
			$('.teamCompareTable').html("Some problem occurred trying to run Ottelulista");
			$('.optimalChangeDay').html("Some problem occurred trying to run Ottelulista");
		}
	});
}

function Pelaajalista(subList) {
	if (subList === undefined) {
		subList = 'playerList,periodOptionMenu,yearOptionMenu';
	}
	var league = getSelectedLeague();
	var vuosi = $('#Pelaajalista').find('.yearOptionMenu option:selected').html();
	var period = $('#Pelaajalista').find('.periodOptionMenu option:selected').html();

	ga('set', 'page', '/virtual/' + league + '/Pelaajalista.html');
	ga('send', 'pageview');

	$.ajax({
		type: 'POST',
		url: 'lp.pl',
		data: {'sub':subList,'liiga':league,'vuosi':vuosi,'read_players_from':period},
		dataType: 'json',
		success: function(res) {
			$.each(res, function (name, value) {
				$('#Pelaajalista').find('.' + name).html(value);
			});
			initPlayerListTable();
		},
		error: function() {
			$('.playerList').html("Some problem occurred trying to run Pelaajalista");
		}
	});
}

function Optimijoukkue(subList) {
	if (subList === undefined) {
		subList = 'selectedTeams,optimiJoukkue,maxPelatutPelit,periodOptionMenu,startDayOption,endDayOption';
	}
	var league = getSelectedLeague();
	var period = $('#Optimijoukkue').find('.periodOptionMenu option:selected').html();
	var startDay = $('#Optimijoukkue').find('.startDayOption option:selected').html();
	var endDay = $('#Optimijoukkue').find('.endDayOption option:selected').html();
	var playerValue = $('#Optimijoukkue').find('.arvo option:selected').html();
	var minGames = $('#Optimijoukkue').find('.maxPelatutPelit option:selected').html();
	var teamValue = $('.joukkueenHinta').val();
	var removedPlayers = $('.removedPlayers').val();
	var selectedTeams = $('.selectedTeams').val();
	var teams = $('.selectedTeams').text();

	var g = $('#Optimijoukkue').find('#o_maalivahti option:selected').val();
	var d1 = $('#Optimijoukkue').find('#o_puolustaja1 option:selected').val();
	var d2 = $('#Optimijoukkue').find('#o_puolustaja2 option:selected').val();
	var f1 = $('#Optimijoukkue').find('#o_hyokkaaja1 option:selected').val();
	var f2 = $('#Optimijoukkue').find('#o_hyokkaaja2 option:selected').val();
	var f3 = $('#Optimijoukkue').find('#o_hyokkaaja3 option:selected').val();

	ga('set', 'page', '/virtual/' + league + '/Optimijoukkue.html');
	ga('send', 'pageview');

	$.ajax({
		type: 'POST',
		url: 'lp.pl',
		data: {'sub':subList,'liiga':league,'read_players_from':period,'start_day':startDay,'end_day':endDay,'selected_teams':teams,'arvo':playerValue,'ottelut':minGames,'joukkueen_hinta':teamValue,'remove_players':removedPlayers,'selected_teams':selectedTeams,'o_maalivahti':g,'o_puolustaja1':d1,'o_puolustaja2':d2,'o_hyokkaaja1':f1,'o_hyokkaaja2':f2,'o_hyokkaaja3':f3},
		dataType: 'json',
		success: function(res) {
			$.each(res, function (name, value) {
				$('#Optimijoukkue').find('.' + name).html(value);
			});
		},
		error: function() {
			$('.optimiJoukkue').html("Some problem occurred trying to run Pelaajalista");
		}
	});
}

function Kokoonpanot(homeTeam, gameNumber) {
	if (homeTeam === undefined) {
		subList = 'kokoonpanotGames';
	} else {
		subList = 'kokoonpanotGames,kokoonpanot';
	}
	var league = getSelectedLeague();
	var period = $('#Kokoonpanot').find('.read_players_from option:selected').html();

	ga('set', 'page', '/virtual/' + league + '/Kokoonpanot.html');
	ga('send', 'pageview');

	$.ajax({
		type: 'POST',
		url: 'lp.pl',
		data: {'sub':subList,'liiga':league,'joukkue':homeTeam,'game_nro':gameNumber,'read_players_from':period},
		dataType: 'json',
		success: function(res) {
			$.each(res, function (name, value) {
				$('#Kokoonpanot').find('.' + name).html(value);
			});
		},
		error: function() {
			$('#kokoonpanot').html("Some problem occurred trying to run Kokoonpanot");
		}
	});
}

function Status() {
	ga('set', 'page', '/virtual/status.html');
	ga('send', 'pageview');

	$("#Status").load("status.html", function(responseTxt, statusTxt, xhr){
		if(statusTxt == "success")
			$("#Status").html(responseTxt);
		if(statusTxt == "error")
			$("#Status").html("Error: " + xhr.status + ": " + xhr.statusText);
	});
}
</script>

<div class="page w3-container w3-padding-top w3-padding-bottom">

<div id="Ottelulista" class="link">
	<div class="w3-center w3-responsive">
		<button class="w3-btn slideButton" onclick="showSlide(1)">Ottelulista</button>
		<button class="w3-btn slideButton" onclick="showSlide(2)">Vastustajat</button>
		<button class="w3-btn slideButton" onclick="showSlide(3)">Vaihdon ajoitus</button>
	</div>
	<center><p>
	Alku: <select class='startDayOption' onchange='Ottelulista()'></select>
	Loppu: <select class='endDayOption' onchange='Ottelulista()'></select><p>
	<div style='overflow:auto;' class="slideDiv gameDays"></div>
	<div style='overflow:auto;' class="slideDiv teamCompareTable"></div>
	<div style='overflow:auto;' class="slideDiv optimalChangeDay"></div>
	</center>
</div>

<div id="Pelaajalista" class="link">
	<center>
	<div style='overflow:auto;'>
	<table border='1'><tr>
		<td>
			<select class='yearOptionMenu' onchange="Pelaajalista('playerList')"></select>
		</td>
		<td>
			<select class='periodOptionMenu' onchange="Pelaajalista('playerList')"></select>
		</td>
		<p id="nimi" style="display:inline"></p>
		<td>
			<p id="pelipaikka" style="display:inline"></p>
		</td>
		<td>
			<p id="joukkue" style="display:inline"></p>
		</td>
		<p id="pelit" style="display:inline"></p>
		<p id="maalit" style="display:inline"></p>
		<p id="syotot" style="display:inline"></p>
		<p id="pisteet" style="display:inline"></p>
		<p id="laukaukset" style="display:inline"></p>
		<p id="arvo" style="display:inline"></p>
		<p id="lpp" style="display:inline"></p>
		<p id="lpp_per_peli" style="display:inline"></p>
		<p id="hinta_per_laatu" style="display:inline"></p>
		<p id="ennuste_graafi" style="display:inline"></p>
	</tr></table>
	</div>

	<div style='overflow:auto;' class="playerList"></div>
	</center>
</div>

<div id="Optimijoukkue" class="link">
	<center>
	Täällä voit koota laskennallisia optimikokoonpanoja antamillasi ehdoilla.<br>

	<div style='max-width: 800px;'>
	<div style='overflow:auto;'>
	<table border='1' class='w3-text-black w3-striped w3-white' style='white-space: nowrap; width: 100%'>
		<tr class='w3-black'>
			<th>Joukkueen arvo tE</th>
			<th colspan='2'>Laskennan aikaväli</th>
			<th>Jakso</th>
			<th>Pelatut pelit väh.</th>
			<th>Pelaajan arvo alle</th>
		</tr>
		<tr>
			<td class='w3-center'> <input style='width: 100%' type='text' class='joukkueenHinta' maxlength='6' value=2000.0> </td>
			<td class='w3-center'> <select style='width: 100%' class='startDayOption' onchange="Optimijoukkue('endDayOption,optimiJoukkue')"></select> </td>
			<td class='w3-center'> <select style='width: 100%' class='endDayOption' onchange="Optimijoukkue('startDayOption,optimiJoukkue')"></select> </td>
			<td class='w3-center'> <select style='width: 100%' class="periodOptionMenu" onchange="Optimijoukkue('optimiJoukkue,maxPelatutPelit')"></select> </td>
			<td class='w3-center'> <select style='width: 100%' class="maxPelatutPelit" onchange="Optimijoukkue('optimiJoukkue')"></select>	</td>

			<td class='w3-center'>    
			<select style='width: 100%' class="arvo" onchange="Optimijoukkue('optimiJoukkue')">
			<option>999</option>
			<option>600</option>
			<option>550</option>
			<option>500</option>
			<option>450</option>
			<option>400</option>
			<option>350</option>
			<option>300</option>
			<option>250</option>
			</select>
			</td>


		</tr>
	</table>
	</div>
	<br>
	<div style='overflow:auto;'>
	<table border='1' class='w3-text-black w3-striped w3-white' style='width: 100%'>
		<tr class='w3-black'>
			<th style='width: 50%'>Kopioi tähän pelaajien nimiä, jotka haluat skipata.<br>Esim. loukkaantuneita pelaajia.</th>
			<th>Pelaajat valitaan näistä joukkueista.<br>Poista joukkue, josta et halua pelaajia.</th>
		</tr>
		<tr>
			<td class='w3-center'><textarea class='removedPlayers' rows=3 style='width: 100%'></textarea></td>
			<td class='w3-center'><textarea class='selectedTeams' rows=3 style='width: 100%'></textarea><br></td>
		</tr>
	</table>
	</div>
	<br>
	<div class="w3-responsive optimiJoukkue"></div>
	</div>
	</center>
</div>

<div id="Kokoonpanot" class="link">
	<center>
	<div class="kokoonpanotGames"></div><br>
	<div class="kokoonpanot">
		<div class="w3-card-4" style="width:50%;">
		<header class="w3-container w3-black">
		<b><p>Älykkäät kokoonpanot<p></b>
		</header>

		<div class="w3-container w3-white">
			<p>Ketjukoostumukset on höystetty pelaajien tilastoilla.
			Lisäksi alla on lista pelaajista, jotka ovat jääneet kokoonpanojen ulkopuolelle.<br><br>
			Kokoonpanot haetaan Liigan sivuilta.</p>
		</div>
		</div>
	</div>
	<center>
</div>

<div id="Status" class="link">
</div>

</div>
</body>
</html>
